<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- This file was created with the aha Ansi HTML Adapter. https://github.com/theZiz/aha -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xml+xhtml; charset=UTF-8" />
<title>stdin</title>
</head>
<body style="color:white; background-color:black">
<pre>
<span style="font-weight:bold;color:lime;">rcw@xps</span>:<span style="font-weight:bold;color:#3333FF;">~/Projects/HelloTerraform</span>$ checkov -d .
<span style="color:#3333FF;">terraform scan results:</span>
<span style="color:aqua;">
Passed checks: 15, Failed checks: 6, Skipped checks: 0
</span>
<span style="color:white;">Check: CKV_AWS_7: &quot;Ensure rotation for customer created CMKs is enabled&quot;
</span><span style="color:lime;">	PASSED for resource: aws_kms_key.mykey
</span><span style="color:fuchsia;">	File: /logging.tf:1-5
</span>	Guide: <span style="font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;color:#3333FF;">https://docs.bridgecrew.io/docs/logging_8
</span>
<span style="color:white;">Check: CKV_AWS_21: &quot;Ensure all data stored in the S3 bucket have versioning enabled&quot;
</span><span style="color:lime;">	PASSED for resource: aws_s3_bucket.log_bucket
</span><span style="color:fuchsia;">	File: /logging.tf:7-35
</span>	Guide: <span style="font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;color:#3333FF;">https://docs.bridgecrew.io/docs/s3_16-enable-versioning
</span>
<span style="color:white;">Check: CKV_AWS_19: &quot;Ensure all data stored in the S3 bucket is securely encrypted at rest&quot;
</span><span style="color:lime;">	PASSED for resource: aws_s3_bucket.log_bucket
</span><span style="color:fuchsia;">	File: /logging.tf:7-35
</span>	Guide: <span style="font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;color:#3333FF;">https://docs.bridgecrew.io/docs/s3_14-data-encrypted-at-rest
</span>
<span style="color:white;">Check: CKV_AWS_20: &quot;S3 Bucket has an ACL defined which allows public READ access.&quot;
</span><span style="color:lime;">	PASSED for resource: aws_s3_bucket.log_bucket
</span><span style="color:fuchsia;">	File: /logging.tf:7-35
</span>	Guide: <span style="font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;color:#3333FF;">https://docs.bridgecrew.io/docs/s3_1-acl-read-permissions-everyone
</span>
<span style="color:white;">Check: CKV_AWS_57: &quot;S3 Bucket has an ACL defined which allows public WRITE access.&quot;
</span><span style="color:lime;">	PASSED for resource: aws_s3_bucket.log_bucket
</span><span style="color:fuchsia;">	File: /logging.tf:7-35
</span>	Guide: <span style="font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;color:#3333FF;">https://docs.bridgecrew.io/docs/s3_2-acl-write-permissions-everyone
</span>
<span style="color:white;">Check: CKV_AWS_70: &quot;Ensure S3 bucket does not allow an action with any Principal&quot;
</span><span style="color:lime;">	PASSED for resource: aws_s3_bucket.log_bucket
</span><span style="color:fuchsia;">	File: /logging.tf:7-35
</span>	Guide: <span style="font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;color:#3333FF;">https://docs.bridgecrew.io/docs/bc_aws_s3_23
</span>
<span style="color:white;">Check: CKV_AWS_18: &quot;Ensure the S3 bucket has access logging enabled&quot;
</span><span style="color:lime;">	PASSED for resource: aws_s3_bucket.frontend
</span><span style="color:fuchsia;">	File: /frontend.tf:1-28
</span>	Guide: <span style="font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;color:#3333FF;">https://docs.bridgecrew.io/docs/s3_13-enable-logging
</span>
<span style="color:white;">Check: CKV_AWS_21: &quot;Ensure all data stored in the S3 bucket have versioning enabled&quot;
</span><span style="color:lime;">	PASSED for resource: aws_s3_bucket.frontend
</span><span style="color:fuchsia;">	File: /frontend.tf:1-28
</span>	Guide: <span style="font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;color:#3333FF;">https://docs.bridgecrew.io/docs/s3_16-enable-versioning
</span>
<span style="color:white;">Check: CKV_AWS_57: &quot;S3 Bucket has an ACL defined which allows public WRITE access.&quot;
</span><span style="color:lime;">	PASSED for resource: aws_s3_bucket.frontend
</span><span style="color:fuchsia;">	File: /frontend.tf:1-28
</span>	Guide: <span style="font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;color:#3333FF;">https://docs.bridgecrew.io/docs/s3_2-acl-write-permissions-everyone
</span>
<span style="color:white;">Check: CKV_AWS_70: &quot;Ensure S3 bucket does not allow an action with any Principal&quot;
</span><span style="color:lime;">	PASSED for resource: aws_s3_bucket.frontend
</span><span style="color:fuchsia;">	File: /frontend.tf:1-28
</span>	Guide: <span style="font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;color:#3333FF;">https://docs.bridgecrew.io/docs/bc_aws_s3_23
</span>
<span style="color:white;">Check: CKV_AWS_41: &quot;Ensure no hard coded AWS access key and and secret key exists in provider&quot;
</span><span style="color:lime;">	PASSED for resource: aws.default
</span><span style="color:fuchsia;">	File: /lambda.tf:9-11
</span>	Guide: <span style="font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;color:#3333FF;">https://docs.bridgecrew.io/docs/bc_aws_secrets_5
</span>
<span style="color:white;">Check: CKV_AWS_50: &quot;X-ray tracing is enabled for Lambda&quot;
</span><span style="color:lime;">	PASSED for resource: aws_lambda_function.hello_terraform
</span><span style="color:fuchsia;">	File: /lambda.tf:30-42
</span>	Guide: <span style="font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;color:#3333FF;">https://docs.bridgecrew.io/page/guideline-does-not-exist
</span>
<span style="color:white;">Check: CKV_AWS_45: &quot;Ensure no hard coded AWS access key and secret key exists in lambda environment&quot;
</span><span style="color:lime;">	PASSED for resource: aws_lambda_function.hello_terraform
</span><span style="color:fuchsia;">	File: /lambda.tf:30-42
</span>	Guide: <span style="font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;color:#3333FF;">https://docs.bridgecrew.io/docs/bc_aws_secrets_3
</span>
<span style="color:white;">Check: CKV_AWS_60: &quot;Ensure IAM role allows only specific services or principals to assume it&quot;
</span><span style="color:lime;">	PASSED for resource: aws_iam_role.lambda_exec
</span><span style="color:fuchsia;">	File: /lambda.tf:44-47
</span>	Guide: <span style="font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;color:#3333FF;">https://docs.bridgecrew.io/docs/bc_aws_iam_44
</span>
<span style="color:white;">Check: CKV_AWS_61: &quot;Ensure IAM role allows only specific principals in account to assume it&quot;
</span><span style="color:lime;">	PASSED for resource: aws_iam_role.lambda_exec
</span><span style="color:fuchsia;">	File: /lambda.tf:44-47
</span>	Guide: <span style="font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;color:#3333FF;">https://docs.bridgecrew.io/docs/bc_aws_iam_45
</span>
<span style="color:white;">Check: CKV_AWS_52: &quot;Ensure S3 bucket has MFA delete enabled&quot;
</span><span style="color:red;">	FAILED for resource: aws_s3_bucket.log_bucket
</span><span style="color:fuchsia;">	File: /logging.tf:7-35
</span>
		<span style="color:white;">7  | </span><span style="color:yellow;">resource &quot;aws_s3_bucket&quot; &quot;log_bucket&quot; {
		</span><span style="color:white;">8  | </span><span style="color:yellow;">  bucket = &quot;c3d64c05-3c3e-43e1-813e-5035bec7ada8-logs&quot;
		</span><span style="color:white;">9  | </span><span style="color:yellow;">  acl    = &quot;log-delivery-write&quot;
		</span><span style="color:white;">10 | </span><span style="color:yellow;">  versioning {
		</span><span style="color:white;">11 | </span><span style="color:yellow;">    enabled = true
		</span><span style="color:white;">12 |     # Terraform must be integrated w/ MFA in order to be able to apply this
		13 |     # setting.  That integration seems to be a PITA, so calling it out of
		14 |     # scope for this exercise.
		15 | </span><span style="color:yellow;">
		</span><span style="color:white;">16 |     # mfa_delete = true
		17 | </span><span style="color:yellow;">  }
		</span><span style="color:white;">18 | </span><span style="color:yellow;">  server_side_encryption_configuration {
		</span><span style="color:white;">19 | </span><span style="color:yellow;">    rule {
		</span><span style="color:white;">20 | </span><span style="color:yellow;">      apply_server_side_encryption_by_default {
		</span><span style="color:white;">21 | </span><span style="color:yellow;">        kms_master_key_id = aws_kms_key.mykey.arn
		</span><span style="color:white;">22 | </span><span style="color:yellow;">        sse_algorithm     = &quot;aws:kms&quot;
		</span><span style="color:white;">23 | </span><span style="color:yellow;">      }
		</span><span style="color:white;">24 | </span><span style="color:yellow;">    }
		</span><span style="color:white;">25 | </span><span style="color:yellow;">  }
		</span><span style="color:white;">26 |   # I didn't find a way to manage logging for the logging bucket itself in
		27 |   # Terraform without running into either cyclic or self-reference issues.
		28 |   # Curious to know if there is a best practice to solve this problem or if the
		29 |   # best bet is just to manually define and lock down the logging bucket first.
		30 | </span><span style="color:yellow;">
		</span><span style="color:white;">31 |   # logging {
		32 |   #   target_bucket = aws_s3_bucket.meta_log_bucket.id
		33 |   #   target_prefix = &quot;log/&quot;
		34 |   # }
		35 | </span><span style="color:yellow;">}

</span>
<span style="color:white;">Check: CKV_AWS_18: &quot;Ensure the S3 bucket has access logging enabled&quot;
</span><span style="color:red;">	FAILED for resource: aws_s3_bucket.log_bucket
</span><span style="color:fuchsia;">	File: /logging.tf:7-35
</span>	Guide: <span style="font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;color:#3333FF;">https://docs.bridgecrew.io/docs/s3_13-enable-logging
</span>
		<span style="color:white;">7  | </span><span style="color:yellow;">resource &quot;aws_s3_bucket&quot; &quot;log_bucket&quot; {
		</span><span style="color:white;">8  | </span><span style="color:yellow;">  bucket = &quot;c3d64c05-3c3e-43e1-813e-5035bec7ada8-logs&quot;
		</span><span style="color:white;">9  | </span><span style="color:yellow;">  acl    = &quot;log-delivery-write&quot;
		</span><span style="color:white;">10 | </span><span style="color:yellow;">  versioning {
		</span><span style="color:white;">11 | </span><span style="color:yellow;">    enabled = true
		</span><span style="color:white;">12 |     # Terraform must be integrated w/ MFA in order to be able to apply this
		13 |     # setting.  That integration seems to be a PITA, so calling it out of
		14 |     # scope for this exercise.
		15 | </span><span style="color:yellow;">
		</span><span style="color:white;">16 |     # mfa_delete = true
		17 | </span><span style="color:yellow;">  }
		</span><span style="color:white;">18 | </span><span style="color:yellow;">  server_side_encryption_configuration {
		</span><span style="color:white;">19 | </span><span style="color:yellow;">    rule {
		</span><span style="color:white;">20 | </span><span style="color:yellow;">      apply_server_side_encryption_by_default {
		</span><span style="color:white;">21 | </span><span style="color:yellow;">        kms_master_key_id = aws_kms_key.mykey.arn
		</span><span style="color:white;">22 | </span><span style="color:yellow;">        sse_algorithm     = &quot;aws:kms&quot;
		</span><span style="color:white;">23 | </span><span style="color:yellow;">      }
		</span><span style="color:white;">24 | </span><span style="color:yellow;">    }
		</span><span style="color:white;">25 | </span><span style="color:yellow;">  }
		</span><span style="color:white;">26 |   # I didn't find a way to manage logging for the logging bucket itself in
		27 |   # Terraform without running into either cyclic or self-reference issues.
		28 |   # Curious to know if there is a best practice to solve this problem or if the
		29 |   # best bet is just to manually define and lock down the logging bucket first.
		30 | </span><span style="color:yellow;">
		</span><span style="color:white;">31 |   # logging {
		32 |   #   target_bucket = aws_s3_bucket.meta_log_bucket.id
		33 |   #   target_prefix = &quot;log/&quot;
		34 |   # }
		35 | </span><span style="color:yellow;">}

</span>
<span style="color:white;">Check: CKV_AWS_52: &quot;Ensure S3 bucket has MFA delete enabled&quot;
</span><span style="color:red;">	FAILED for resource: aws_s3_bucket.frontend
</span><span style="color:fuchsia;">	File: /frontend.tf:1-28
</span>
		<span style="color:white;">1  | </span><span style="color:yellow;">resource &quot;aws_s3_bucket&quot; &quot;frontend&quot; {
		</span><span style="color:white;">2  | </span><span style="color:yellow;">  bucket = &quot;bbad86bf-e69b-49ba-b02f-54911cb672ab-frontend&quot;
		</span><span style="color:white;">3  |   # As a static website bucket, this is world-readable and unencrypted by
		4  |   # design.  Looks like I could suppress the alerts with `--skip-check`, but I
		5  |   # like the visibility.
		6  | </span><span style="color:yellow;">  acl = &quot;public-read&quot;
		</span><span style="color:white;">7  | </span><span style="color:yellow;">  website { index_document = &quot;index.html&quot; }
		</span><span style="color:white;">8  | </span><span style="color:yellow;">  versioning {
		</span><span style="color:white;">9  | </span><span style="color:yellow;">    enabled = true
		</span><span style="color:white;">10 |     # Terraform must be integrated w/ MFA in order to be able to apply this
		11 |     # setting.  That integration seems to be a PITA, so calling it out of
		12 |     # scope for this exercise.
		13 | </span><span style="color:yellow;">
		</span><span style="color:white;">14 |     # mfa_delete = true
		15 | </span><span style="color:yellow;">  }
		</span><span style="color:white;">16 |   # server_side_encryption_configuration {
		17 |   #   rule {
		18 |   #     apply_server_side_encryption_by_default {
		19 |   #       kms_master_key_id = aws_kms_key.mykey.arn
		20 |   #       sse_algorithm     = &quot;aws:kms&quot;
		21 |   #     }
		22 |   #   }
		23 |   # }
		24 | </span><span style="color:yellow;">  logging {
		</span><span style="color:white;">25 | </span><span style="color:yellow;">    target_bucket = aws_s3_bucket.log_bucket.id
		</span><span style="color:white;">26 | </span><span style="color:yellow;">    target_prefix = &quot;log/&quot;
		</span><span style="color:white;">27 | </span><span style="color:yellow;">  }
		</span><span style="color:white;">28 | </span><span style="color:yellow;">}

</span>
<span style="color:white;">Check: CKV_AWS_19: &quot;Ensure all data stored in the S3 bucket is securely encrypted at rest&quot;
</span><span style="color:red;">	FAILED for resource: aws_s3_bucket.frontend
</span><span style="color:fuchsia;">	File: /frontend.tf:1-28
</span>	Guide: <span style="font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;color:#3333FF;">https://docs.bridgecrew.io/docs/s3_14-data-encrypted-at-rest
</span>
		<span style="color:white;">1  | </span><span style="color:yellow;">resource &quot;aws_s3_bucket&quot; &quot;frontend&quot; {
		</span><span style="color:white;">2  | </span><span style="color:yellow;">  bucket = &quot;bbad86bf-e69b-49ba-b02f-54911cb672ab-frontend&quot;
		</span><span style="color:white;">3  |   # As a static website bucket, this is world-readable and unencrypted by
		4  |   # design.  Looks like I could suppress the alerts with `--skip-check`, but I
		5  |   # like the visibility.
		6  | </span><span style="color:yellow;">  acl = &quot;public-read&quot;
		</span><span style="color:white;">7  | </span><span style="color:yellow;">  website { index_document = &quot;index.html&quot; }
		</span><span style="color:white;">8  | </span><span style="color:yellow;">  versioning {
		</span><span style="color:white;">9  | </span><span style="color:yellow;">    enabled = true
		</span><span style="color:white;">10 |     # Terraform must be integrated w/ MFA in order to be able to apply this
		11 |     # setting.  That integration seems to be a PITA, so calling it out of
		12 |     # scope for this exercise.
		13 | </span><span style="color:yellow;">
		</span><span style="color:white;">14 |     # mfa_delete = true
		15 | </span><span style="color:yellow;">  }
		</span><span style="color:white;">16 |   # server_side_encryption_configuration {
		17 |   #   rule {
		18 |   #     apply_server_side_encryption_by_default {
		19 |   #       kms_master_key_id = aws_kms_key.mykey.arn
		20 |   #       sse_algorithm     = &quot;aws:kms&quot;
		21 |   #     }
		22 |   #   }
		23 |   # }
		24 | </span><span style="color:yellow;">  logging {
		</span><span style="color:white;">25 | </span><span style="color:yellow;">    target_bucket = aws_s3_bucket.log_bucket.id
		</span><span style="color:white;">26 | </span><span style="color:yellow;">    target_prefix = &quot;log/&quot;
		</span><span style="color:white;">27 | </span><span style="color:yellow;">  }
		</span><span style="color:white;">28 | </span><span style="color:yellow;">}

</span>
<span style="color:white;">Check: CKV_AWS_20: &quot;S3 Bucket has an ACL defined which allows public READ access.&quot;
</span><span style="color:red;">	FAILED for resource: aws_s3_bucket.frontend
</span><span style="color:fuchsia;">	File: /frontend.tf:1-28
</span>	Guide: <span style="font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;color:#3333FF;">https://docs.bridgecrew.io/docs/s3_1-acl-read-permissions-everyone
</span>
		<span style="color:white;">1  | </span><span style="color:yellow;">resource &quot;aws_s3_bucket&quot; &quot;frontend&quot; {
		</span><span style="color:white;">2  | </span><span style="color:yellow;">  bucket = &quot;bbad86bf-e69b-49ba-b02f-54911cb672ab-frontend&quot;
		</span><span style="color:white;">3  |   # As a static website bucket, this is world-readable and unencrypted by
		4  |   # design.  Looks like I could suppress the alerts with `--skip-check`, but I
		5  |   # like the visibility.
		6  | </span><span style="color:yellow;">  acl = &quot;public-read&quot;
		</span><span style="color:white;">7  | </span><span style="color:yellow;">  website { index_document = &quot;index.html&quot; }
		</span><span style="color:white;">8  | </span><span style="color:yellow;">  versioning {
		</span><span style="color:white;">9  | </span><span style="color:yellow;">    enabled = true
		</span><span style="color:white;">10 |     # Terraform must be integrated w/ MFA in order to be able to apply this
		11 |     # setting.  That integration seems to be a PITA, so calling it out of
		12 |     # scope for this exercise.
		13 | </span><span style="color:yellow;">
		</span><span style="color:white;">14 |     # mfa_delete = true
		15 | </span><span style="color:yellow;">  }
		</span><span style="color:white;">16 |   # server_side_encryption_configuration {
		17 |   #   rule {
		18 |   #     apply_server_side_encryption_by_default {
		19 |   #       kms_master_key_id = aws_kms_key.mykey.arn
		20 |   #       sse_algorithm     = &quot;aws:kms&quot;
		21 |   #     }
		22 |   #   }
		23 |   # }
		24 | </span><span style="color:yellow;">  logging {
		</span><span style="color:white;">25 | </span><span style="color:yellow;">    target_bucket = aws_s3_bucket.log_bucket.id
		</span><span style="color:white;">26 | </span><span style="color:yellow;">    target_prefix = &quot;log/&quot;
		</span><span style="color:white;">27 | </span><span style="color:yellow;">  }
		</span><span style="color:white;">28 | </span><span style="color:yellow;">}

</span>
<span style="color:white;">Check: CKV_AWS_59: &quot;Ensure there is no open access to back-end resources through API&quot;
</span><span style="color:red;">	FAILED for resource: aws_api_gateway_method.proxy
</span><span style="color:fuchsia;">	File: /api_gateway.tf:24-31
</span>	Guide: <span style="font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;"></span><span style="text-decoration:underline;font-weight:bold;color:#3333FF;">https://docs.bridgecrew.io/docs/public_6-api-gateway-authorizer-set
</span>
		<span style="color:white;">24 | </span><span style="color:yellow;">resource &quot;aws_api_gateway_method&quot; &quot;proxy&quot; {
		</span><span style="color:white;">25 | </span><span style="color:yellow;">  rest_api_id = aws_api_gateway_rest_api.hello_terraform.id
		</span><span style="color:white;">26 | </span><span style="color:yellow;">  resource_id = aws_api_gateway_resource.proxy.id
		</span><span style="color:white;">27 | </span><span style="color:yellow;">  http_method = &quot;ANY&quot;
		</span><span style="color:white;">28 |   # In a real app, this would have a user-pool / API key(s), etc. behind it as
		29 |   # opposed to no auth.
		30 | </span><span style="color:yellow;">  authorization = &quot;NONE&quot;
		</span><span style="color:white;">31 | </span><span style="color:yellow;">}

</span>
<span style="font-weight:bold;color:lime;">rcw@xps</span>:<span style="font-weight:bold;color:#3333FF;">~/Projects/HelloTerraform</span>
</pre>
</body>
</html>
